---
title: "SSC/IA: High Level Partner Nation Summaries"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
space <- read.csv("space.csv", header = TRUE)
UK <- read.csv("UK.csv", header = TRUE)
new_UK <- read.csv("new_UK.csv", header = TRUE)
newest_UK <- read.csv("newest_UK.csv", header = TRUE) %>% filter(Operator.Owner != "O3b Networks Ltd.")

LUX <- filter(space, Country.of.Operator.Owner == "Luxembourg")
lux_yrs <- c()
for (i in 1:length(LUX$Date.of.Launch)){
  item <- (str_split(LUX$Date.of.Launch, ".*/"))[[i]][2]
  lux_yrs <- c(lux_yrs, as.numeric(item))
}
LUX$Years <- lux_yrs

NOR <- filter(space, Country.of.Operator.Owner == "Norway")
nor_yrs <- c()
for (i in 1:length(NOR$Date.of.Launch)){
  item <- (str_split(NOR$Date.of.Launch, ".*/"))[[i]][2]
  nor_yrs <- c(nor_yrs, as.numeric(item))
}
NOR$Years <- nor_yrs
NOR$Contractor <- c(rep("Kongsberg Seatex AS", 2), rep("Norwegian Space Center", 3))

df <- data.frame(x = c(1,2,3), y = c(2,4,1))
df_2 <- data.frame(x = c(1,2,3), y = c(4,1,1))
def_3 <- data.frame(x = c(1,2,3,4,5,6), y = c(4,3,1,4,2,1))
df_4 <- data.frame(x = c(1,2), y = c(2,3))

```

# Overview {.sidebar}

Data for these dashboards is sourced from the Union of Concerned Scientists Satellite Catalog, most recently updated on **May 1, 2022**.

More information on the Union of Concerned Scientists and their carefully curated Satellite Catalog can be found [here](https://www.ucsusa.org/resources/satellite-database)

UK {data-icon="fa-signal"}
=====================================

Column {data-width=650}
-----------------------------------------------------------------------

### UK Public Space Profile

```{r}
ggplot(UK, aes(Years, fill = Purpose)) + geom_histogram(bins = 9, color = "black") + labs(x = "Years", y = "Space Assets Launched") + scale_y_discrete("Space Assets Launched", limits = seq(0, 13, 2)) + 
  guides(fill = guide_legend("Capability Type"))
```

Column {data-width=350}
-----------------------------------------------------------------------

### UK Production for International Parties

```{r}
ggplot() + geom_bar(data = new_UK, aes(x = factor(Purpose), fill = Purpose), width = 1, alpha = 0.6, color = "black") + geom_label(data = df, aes(x = x, y = y, label = y)) + coord_polar() + theme(axis.line = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank()) +
  labs(x = "", y = "Satellites Exported") +
  guides(fill = guide_legend("Capability Type"))

```

### UK Space Acquisitions (Excluding Commercial Communications)

```{r}
ggplot() + geom_bar(data = newest_UK, aes(x = factor(Purpose), fill = Purpose), width = 1, alpha = 0.6, color = "black") + geom_label(data = df_2, aes(x = x, y = y, label = y)) + coord_polar() + theme(axis.line = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank()) +
  labs(x = "", y = "Satellites Acquired") +
  guides(fill = guide_legend("Capability Type"))
```

LUX {data-icon="fa-signal"}
=====================================

Column {data-width=650}
-----------------------------------------------------------------------

### LUX Commercial SATCOM Profile

```{r}
ggplot(LUX, aes(Years)) + geom_histogram(bins = 9, color = "black", fill = "red", alpha = 0.7) + labs(x = "Years", y = "Space Assets Launched") + scale_y_discrete("Space Assets Launched", limits = seq(0, 10, 1))
```

Column {data-width=350}
-----------------------------------------------------------------------

### Firms Supplying SATCOM Capabilities to LUX

```{r}
ggplot() + geom_bar(data = LUX, aes(x = factor(Contractor), fill = Contractor), width = 1, alpha = 0.6, color = "black") + geom_label(data = def_3, aes(x = x, y = y, label = y)) + coord_polar() + theme(axis.line = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank()) +
  labs(x = "", y = "Satellites Acquired") +
  guides(fill = guide_legend("Producer"))

```

### Further Descriptions

* All satellites represented in this tab are operated by **SES S.A.**, a Luxembourgish-French satellite telecommunications network provider
* Luxembourg serves as the **country of operation** for these space vehicles
* One notable satellite, **SES-2**, operated through the Luxembourgish-French firm features the Commercially Hosted InfraRed Payload (CHIRP) for U.S. Air Force--wide-field of view sensor to validate space-based infrared technologies from geosynchronous orbit. 


NOR {data-icon="fa-signal"}
=====================================

Column {data-width=650}
-----------------------------------------------------------------------

### Norway Public Space Profile

```{r}
ggplot(NOR, aes(Years, fill = Purpose)) + geom_histogram(bins = 12, color = "black") + labs(x = "Years", y = "Space Assets Launched") + scale_y_discrete("Space Assets Launched", limits = seq(0, 8, 2)) + scale_x_discrete("Years", limits = seq(2010, 2022, 2)) +
  guides(fill = guide_legend("Capability Type"))
```

Column {data-width=350}
-----------------------------------------------------------------------

### Firms Supplying Space Assets to Norway

```{r}
ggplot() + geom_bar(data = NOR, aes(x = factor(Contractor), fill = Contractor), width = 1, alpha = 0.6, color = "black") + geom_label(data = df_4, aes(x = x, y = y, label = y)) + coord_polar() + theme(axis.line = element_blank(),
    plot.background = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank()) +
  labs(x = "", y = "Satellites Acquired") +
  guides(fill = guide_legend("Producer"))

```

### Further Descriptions

* All satellites represented in this tab serve as **Automatic Identification Systems (AIS)**
* **NorSat-1** conducts solar radiation measurements and is operated through the Norwegian Space Center 
